<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">
<head>
<meta charset="utf-8" />
<title>Guide Myclass</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="author" content="Untree.co" />
<meta name="description" content="" />
 <meta name="keywords" content="bootstrap, bootstrap5" />
<style>
	.table{
		text-align: center;
		margin: 30px;
	}
	
	.table td img{
		max-width: 100%;
	}
	.alert {
	    position: relative;
	    padding: 2rem 2rem;
	    margin-bottom: 1rem;
	    border: none solid transparent;
	    border-radius: 0.25rem;
	    font-size: 1.6rem;
	}
</style>
</head>
<body>
<div layout:fragment="content">
	<div class="card">
		<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
		<input type="hidden" id="memberId" th:value="${#authentication.principal.member.memberId}" /> 
		<div class="alert alert-light-primary color-primary">I-Class</div>
			<!-- 클래스 등록/승인요청한 클래스 버튼 -->
			<div class="row" style="margin-bottom: 30px; padding-left: 10px;">
				<div>
					<button id="startClass" style="width: 140px;" class="btn btn-sm btn-primary">등록하기</button>
					<button id="alreadyClass" style="width: 150px;" class="btn btn-sm btn-primary">등록한 클래스 목록</button>
				</div>
				<div th:each="classlist : ${classList}" th:if="${classlist.confmCd == '2'}" style="width: 380px; display: inline-block;">
								<table class="table table-hover table-bordered" style="width: 300px;">
									<tbody>
										<tr style="display: none;">
											<!-- 클래스 번호 -->
											<td id="classNo" colspan="2" th:text="${classlist.classNo}"></td>
										</tr>
										<tr>
											<!-- 이미지(수정) -->
											<td colspan="2"> <img th:src="@{/download(fileName=${'/CLASS/'+classlist.attachDir})}" alt="Image" class="img-fluid" /></td>
										</tr>
										<tr>
											<td colspan="2" th:text="${classlist.title}"></td>
										</tr>
										<tr>
											<td colspan="2" th:text="${classlist.st}"></td>
										</tr>
										<tr>
											<th>정원</th>
											<td th:text="${classlist.psncpa}+명">></td>
										</tr>
										<tr>
											<th>상태</th>
											<td th:text="${classlist.st}"></td>
										</tr>
										<tr>
											<td colspan="2">
												<div th:if="${classlist.st} == '진행중'" >
							                       <button class="btn btn-primary py-2 px-1 link">링크입력</button>&nbsp;&nbsp;
							                       <button class="btn btn-primary py-2 px-1 classChat" >강의실 입장</button>
							               		</div>
							               		<div th:unless="${classlist.st} == '진행중'" >
							                       <button class="btn btn-primary py-2 px-1 link" disabled='disabled'>링크입력</button>&nbsp;&nbsp;
							                       <button class="btn btn-primary py-2 px-1 classChat" disabled='disabled'>강의실 입장</button>
							               		</div>
											</td>
										</tr>
									</tbody>								
								</table>
							</div>
			</div>
		<script type="text/javascript">
			let memberId = $("#memberId").val(); //현재 접속한 사람 아이디
			
			//클래스 등록
			$("#startClass").on("click", function() {
				location.href = "/startClass.do?";
			})
			
			//등록한 클래스 목록(승인요청중인)
			$("#alreadyClass").on("click", function(){
				location.href = "/alreadyClass";
			})
			
			//채팅방 연결
			$(".classChat").on("click", function(e){
				let classNo = $(e.target).closest("tbody").children(1).children(1).html();
				//console.log(classNo);
				location.href="classChat.do?classNo=" + classNo; 
			})
			
			
        </script>
	</div>
</div>
</body>
</html>