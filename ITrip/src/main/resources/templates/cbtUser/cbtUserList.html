<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="js/jquery-3.6.0.min.js"></script>
<style type="text/css">
.content { /*컨텐츠 넓이지정*/
	position: relative;
	width: 600px;
}

.slides { /*슬라이드 아이템이 나올 뼈대 지정*/
	width: 100px;
	height: 500px;
	position: relative;
}

.slide_item { /*슬라이드 아이템을 absolute로 겹쳐놓고 투명하게 하기*/
	position: absolute;
	width: 600px;
	height: 500px;
	opacity: 0;
	transition: all 0.3s;
}

.ontheSlide { /*현재 아이템에 붙여줄 클래스*/
	opacity: 1;
	transition: all 0.3s;
}

.nextButton, .prevButton { /*다음,이전 버튼을 드래그되지 않게 방지해주기*/
	-webkit-user-select: none;
	-ms-user-select: none;
	user-select: none
}

.nextButton { /*다음 버튼을 오른쪽으로 보내기*/
	float: right;
}

.prevButton { /*왼쪽 버튼을 왼쪽으로 보내기*/
	float: left;
}

.ontheSlide .form-check {
	font-size: 1.5em;
}
</style>
</head>
<body>
<div layout:fragment="content">

<!--
<p class="card-text" th:text="${cbt.cnsr}"></p>
<p class="card-text" th:text="${cbt.memberId}"></p>
<p class="card-text" th:text="${cbt.cbtNo}"></p>
<p class="card-text" th:text="${cbt.cnsrCnt}"></p>
<p class="card-text" th:text="${cbt.call}"></p>
<p class="card-text" th:text="${cbt.utpCd}"></p>
<p class="card-text" th:text="${cbt.explna}"></p>
<img th:src="@{*{attachDir}}" style="width: 100px;  height: 100px;"> 
-->
<!-- <div th:text="${cbtOne.langCd}" ></div> -->
<div th:if="${#lists.isEmpty(cbtOne)}">
	<div class="content" style="margin: 0 auto;">
		<div class="col-xl-4 col-md-6 col-sm-12 slides">
			<div class="card slide_item ontheSlide">
				<div class="card-content">
					<div class="card-header"></div>
					<div class="card-body">
						<h4 class="form-check" style="padding-top: 20%;">아직 등록된 문제가 없습니다. 문제를 등록해주세요.</h4><br><br>
						<div class="buttons" style="text-align: center;">
							<a href="cbtUserInsertForm.do" class="btn btn-primary">문제출제하기</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div th:unless="${#lists.isEmpty(cbtOne)}">
	<div class="content" style="margin: 0 auto;" th:if="${cbtOne.utpCd==1}">
		<div class="col-xl-4 col-md-6 col-sm-12 slides">
			<div class="card slide_item ontheSlide"><!-- th:each="cbt: ${cbtList}" -->
				<div class="card-content">
				<div  id="langBadge" class="badge bg-dark text-white position-absolute" style="top: 0.5rem; right: 0.5rem" th:text="${cbtOne.langCd}"> </div>
					<div id="cardContent">
						<div class="card-header">
							<br><h3 th:text="Q.+${cbtOne.ques}"></h3> <!--  class="card-title" -->
						</div>
						<div class="card-body"> 
							<br>
							<div class="form-check">
								① <a href="" class="ex" th:text="${cbtOne.ex1}"></a><br> 
								② <a href="" class="ex" th:text="${cbtOne.ex2}"></a><br> 
								③ <a href="" class="ex" th:text="${cbtOne.ex3}"></a><br>
								④ <a href="" class="ex" th:text="${cbtOne.ex4}"></a>
							</div>
						</div>
					</div>
				</div><!-- end if card-content -->
			</div><!-- end of slide_item -->
		</div><!-- end of slides  -->
		<div class="buttons btn-group btn-group-lg" role="group"
			style="width: 100%;">
			<button type="button" class="prevButton btn btn-primary">◀</button>
			<button type="button" class="nextButton btn btn-primary">▶</button>
		</div>
	</div><!-- end of content  -->
	<div class="content" style="margin: 0 auto;" th:unless="${cbtOne.utpCd==2}">
		<div class="col-xl-4 col-md-6 col-sm-12 slides">
			<div class="card slide_item ontheSlide"><!-- th:each="cbt: ${cbtList}" -->
				<div class="card-content">
				<div  id="langBadge" class="badge bg-dark text-white position-absolute" style="top: 0.5rem; right: 0.5rem" th:text="${cbtOne.langCd}"> </div>
					<div id="card-content">
						<div class="card-header">
							<br><h3 th:text="Q.+${cbtOne.ques}"></h3> <!--  class="card-title" -->
						</div>
						<div class="card-body"> 
							<br>
							<label for="cnsr" class="form-label">정답</label>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrO" value="O"> O
							</div>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrX" value="X"> X
							</div>
						</div>
					</div>
				</div><!-- end if card-content -->
			</div><!-- end of slide_item -->
		</div><!-- end of slides  -->
		<div class="buttons btn-group btn-group-lg" role="group"
			style="width: 100%;">
			<button type="button" class="prevButton btn btn-primary">◀</button>
			<button type="button" class="nextButton btn btn-primary">▶</button>
		</div>
	</div>
</div><!-- end of th:enless  -->
<div id="pageNum"></div>

<script type="text/javascript">
	//보기 중 하나를 누르면 정답,오답표시
	//객관식문제
	$(".ex").click(function(){
		console.log(this)
	})
	
	//OX문제
	$('input:radio[name=cnsr]').click(function(){
		console.log(this.value)
	})

	//prev,next버튼 누르면 다음문제 ajax로 가져오기
	let langBadge = document.getElementById('langBadge').innerHTML
	const nextButton = document.querySelector('.nextButton');//다음버튼 
	const prevButton = document.querySelector('.prevButton');//이전버튼 
	let savePage = document.getElementById("pageNum").innerHTML;
	let page = 1;
	
	//다음 버튼을 누른다면
	nextButton.addEventListener('click', function() {
		page ++; 
		savePage = page;
		console.log(page)
		console.log(savePage)
		let cardContent = document.getElementById("cardContent")

		 $.ajax({
			url:'/ajaxQuestion.do',
			type:'post',
			dataType:'json',
			data:{langCd:langBadge,rownum:savePage},
			success:function newQ(res){
				cardContent.innerHTML ="";
				if(res.utpCd==1){
					cardContent.innerHTML += 
						`<div class="card-header"><br><h3>Q.${res.ques}</h3></div>
						<div class="card-body"> <br>
							<div class="form-check">
								① <a href="">${res.ex1}</a><br> 
								② <a href="">${res.ex2}</a><br> 
								③ <a href="">${res.ex3}</a><br>
								④ <a href="">${res.ex4}</a>
							</div>
						</div>`
				}
				if(res.utpCd==2){
					cardContent.innerHTML += 
						`<div class="card-header"><br><h3>Q.${res.ques}</h3></div>
						 <div class="card-body"> <br>
							<label for="cnsr" class="form-label">정답</label>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrO" value="O"> O
							</div>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrX" value="X"> X
							</div>
						 </div>`
				}
			},
			error:function err(xhr,err){
				alert("마지막문제입니다. ")
				page--
				console.log(page)
			}
		}) 
	})
	
	//이전 버튼을 누른다면
	prevButton.addEventListener('click', function() {
		page --; 
		savePage = page;
		console.log(page)
		console.log(savePage)
		let cardContent = document.getElementById("card-content")

		 $.ajax({
			url:'/ajaxQuestion.do',
			type:'post',
			dataType:'json',
			data:{langCd:langBadge,rownum:savePage},
			success:function newQ(res){
				cardContent.innerHTML ="";
				if(res.utpCd==1){
					cardContent.innerHTML += 
						`<div class="card-header"><br><h3>Q.${res.ques}</h3></div>
						<div class="card-body"><br>
							<div class="form-check">
								① <a href="">${res.ex1}</a><br> 
								② <a href="">${res.ex2}</a><br> 
								③ <a href="">${res.ex3}</a><br>
								④ <a href="">${res.ex4}</a>
							</div>
						</div>`
				}
				if(res.utpCd==2){
					cardContent.innerHTML += 
						`<div class="card-header"><br><h3>Q.${res.ques}</h3></div>
						 <div class="card-body"> <br>
							<label for="cnsr" class="form-label">정답</label>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrO" value="O"> O
							</div>
							<div class="form-check">
								<input class="form-check-input" type="radio" name="cnsr" id="cnsrX" value="X"> X
							</div>
						 </div>`
				}
				
			},
			error:function err(xhr,err){
				alert("첫번째 문제입니다. ")
				page++
				console.log(page)
			}
		}) 
	})
	
	
</script>

</div>
</body>
</html>