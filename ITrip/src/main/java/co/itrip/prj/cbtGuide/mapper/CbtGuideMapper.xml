<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.itrip.prj.cbtGuide.mapper.CbtGuideMapper">

	<!-- List<CbtGuideVO> cbtGuideList();//전체조회(R) -->
	<select id="cbtGuideList" resultType="co.itrip.prj.cbtGuide.service.CbtGuideVO">
	    SELECT * FROM CBT_GUIDE
	</select>
	
	
	<!-- List<CbtGuideVO> cbtGuideListTab(CbtGuideVO vo); //탭 클릭시 유형별, 언어별로 조회 -->
	<select id="cbtGuideListTab" parameterType="co.itrip.prj.cbtGuide.service.CbtGuideVO" resultType="co.itrip.prj.cbtGuide.service.CbtGuideVO">
	    SELECT * FROM CBT_GUIDE 
	     <if test="gtpCd==4">
			WHERE GTP_CD IN('1','2') AND LANG_CD='${langCd}'
		</if>
		 <if test="gtpCd!=4">
			WHERE GTP_CD=#{gtpCd} AND LANG_CD=#{langCd}
		</if>
	</select>
	
	<!-- public CbtGuideVO ajaxExplnaList(CbtGuideVO VO); // 풀이 단건 리스트 -->
	<select id="ajaxExplnaList" parameterType="co.itrip.prj.cbtGuide.service.CbtGuideVO" resultType="co.itrip.prj.cbtGuide.service.CbtGuideVO">
	    SELECT * FROM CBT_GUIDE WHERE CBT_NO = ${cbtNo}
	</select>
	
	
	<!-- CbtGuideVO cbtGuideListOne(CbtGuideVO VO);//단건조회(R) -->
	<select id="cbtGuideListOne" parameterType="co.itrip.prj.cbtGuide.service.CbtGuideVO" resultType="co.itrip.prj.cbtGuide.service.CbtGuideVO">
	    SELECT * FROM CBT_GUIDE WHERE CBT_NO = ${cbtNo}
	</select>
	
	<!-- public int cbtGuideInsert(CbtGuideVO VO); //등록(C) -->
	<insert id="cbtGuideInsert" parameterType="java.util.List" >
	
	   <selectKey keyProperty="cbtNo" order="BEFORE" resultType="int">
			SELECT CASE WHEN MAX(CBT_NO) IS NULL THEN 1 
				   ELSE  MAX(CBT_NO)+1 END ID 
			FROM CBT_GUIDE
		</selectKey>
		insert into cbt_guide values(#{cbtNo},#{ques},#{cnsr, jdbcType=VARCHAR},#{ex1, jdbcType=VARCHAR},
		            #{ex2, jdbcType=VARCHAR},#{ex3, jdbcType=VARCHAR},#{ex4, jdbcType=VARCHAR},
                    #{attach, jdbcType=VARCHAR},#{attachDir, jdbcType=VARCHAR},0,0,#{explna},#{gtpCd},#{langCd},#{memberId , jdbcType=VARCHAR})
	</insert>
	
	<insert id="KeywordInsert" parameterType="java.util.List">
	    <selectKey keyProperty="kyNo" order="BEFORE" resultType="int">
			SELECT CASE WHEN MAX(KY_NO) IS NULL THEN 1 
				   ELSE  MAX(KY_NO)+1 END ID 
			FROM CBT_KEYWORD
		</selectKey>
	    insert into cbt_keyword(<foreach collection="list" item="item" separator=",">
        #{item.kyNo} , #{item.cKwrd} , ${cbtNo})
    </foreach>)
	</insert>
	
	<!-- public int cbtGuideUpdate(CbtGuideVO VO); //수정(U) -->
	<update id="cbtGuideUpdate">
	</update>
	
	<!-- public int cbutGuideDelet(CbtGuideVO VO);//삭제(D) -->
	<delete id="cbutGuideDelet">
	</delete>
	<!-- public int KeywordInsert(); -->
	<!-- public int KeywordList(); -->
	
	
</mapper>